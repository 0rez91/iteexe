
<html>
<head>
<script>
component = null;
logElement = null;

function log(aText) {
    if (!logElement) {
        logElement = document.getElementById("log");
    }
    logElement.value += '\r\n' + aText;
}

function createComponent() {
    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
    if (!component) {
        log("Creating Component");
        var cls = Components.classes["@exe.org/simpleTest;1"];
        log("Class = " + cls);
        var instance = cls.createInstance();
        log("Instance = " + instance);
        var intf = Components.interfaces.nsIEXESimple;
        log("Interface = " + intf);
        component = instance.QueryInterface(intf);
        log("All up = " + component);
    } else {
        log("Component already created: " + component);
    }
}

function getName() {
    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
    log("Name is currently '" + component.yourName + "'");
}

function changeName(aName) {
    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
    log("Changing name from '" + component.yourName + "'");
    component.change(aName);
    log("Name is now '" + component.yourName + "'");
}

function setName(aName) {
    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
    log("Setting name from '" + component.yourName + "'");
    component.yourName = aName;
    log("Name is now '" + component.yourName + "'");
}

function printName() {
    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
    log("Printing name '" + component.yourName + "'");
    component.write();
}

</script>
</head>
<body>
<h1>EXE Simple PyXPCOM Component Demo/Test Page</h1>

<form>
 <p>
  <input type="button" onclick="createComponent()" value="Create Component"/>
 </p><p>
 Your name: <input type="text" id="theName"/>
 </p><p>
  <input type="button" onclick="setName(document.getElementById('theName').value)" value="Set Name (Property)"/>
  <input type="button" onclick="changeName(document.getElementById('theName').value)" value="Change Name (Method)"/>
  <input type="button" onclick="getName()" value="Get Name (Property)"/>
  <input type="button" onclick="printName()" value="Print Name (stdout)"/>
 </p><p>
  Log:<br/>
  <textarea style="width:80em; height:20em" id="log" />
  </p>
</form>

</body>
</html>
