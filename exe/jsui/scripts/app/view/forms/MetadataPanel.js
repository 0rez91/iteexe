// ===========================================================================
// eXe
// Copyright 2012, Pedro Peña Pérez, Open Phoenix IT
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program; if not, write to the Free Software
// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
//===========================================================================

langs = [
    [
        "aa", 
        "_(Afar )"
    ], 
    [
        "ab", 
        "_(Abkhazian )"
    ], 
    [
        "ae", 
        "_(Avestan )"
    ], 
    [
        "af", 
        "_(Afrikaans )"
    ], 
    [
        "am", 
        "_(Amharic )"
    ], 
    [
        "ar", 
        "_(Arabic )"
    ], 
    [
        "as", 
        "_(Assamese )"
    ], 
    [
        "ay", 
        "_(Aymara )"
    ], 
    [
        "az", 
        "_(Azerbaijani )"
    ], 
    [
        "ba", 
        "_(Bashkir )"
    ], 
    [
        "be", 
        "_(Byelorussian; Belarusian )"
    ], 
    [
        "bg", 
        "_(Bulgarian )"
    ], 
    [
        "bh", 
        "_(Bihari )"
    ], 
    [
        "bi", 
        "_(Bislama )"
    ], 
    [
        "bn", 
        "_(Bengali; Bangla )"
    ], 
    [
        "bo", 
        "_(Tibetan )"
    ], 
    [
        "br", 
        "_(Breton )"
    ], 
    [
        "bs", 
        "_(Bosnian )"
    ], 
    [
        "ca", 
        "_(Catalan )"
    ], 
    [
        "ce", 
        "_(Chechen )"
    ], 
    [
        "ch", 
        "_(Chamorro )"
    ], 
    [
        "co", 
        "_(Corsican )"
    ], 
    [
        "cs", 
        "_(Czech )"
    ], 
    [
        "cu", 
        "_(Church Slavic )"
    ], 
    [
        "cv", 
        "_(Chuvash )"
    ], 
    [
        "cy", 
        "_(Welsh )"
    ], 
    [
        "da", 
        "_(Danish )"
    ], 
    [
        "de", 
        "_(German )"
    ], 
    [
        "dz", 
        "_(Dzongkha; Bhutani )"
    ], 
    [
        "el", 
        "_(Greek )"
    ], 
    [
        "en", 
        "_(English )"
    ], 
    [
        "eo", 
        "_(Esperanto )"
    ], 
    [
        "es", 
        "_(Spanish )"
    ], 
    [
        "et", 
        "_(Estonian )"
    ], 
    [
        "eu", 
        "_(Basque )"
    ], 
    [
        "fa", 
        "_(Persian )"
    ], 
    [
        "fi", 
        "_(Finnish )"
    ], 
    [
        "fj", 
        "_(Fijian; Fiji )"
    ], 
    [
        "fo", 
        "_(Faroese )"
    ], 
    [
        "fr", 
        "_(French )"
    ], 
    [
        "fy", 
        "_(Frisian )"
    ], 
    [
        "ga", 
        "_(Irish )"
    ], 
    [
        "gd", 
        "_(Scots; Gaelic )"
    ], 
    [
        "gl", 
        "_(Gallegan; Galician )"
    ], 
    [
        "gn", 
        "_(Guarani )"
    ], 
    [
        "gu", 
        "_(Gujarati )"
    ], 
    [
        "gv", 
        "_(Manx )"
    ], 
    [
        "ha", 
        "_(Hausa (?) )"
    ], 
    [
        "he", 
        "_(Hebrew (formerly iw) )"
    ], 
    [
        "hi", 
        "_(Hindi )"
    ], 
    [
        "ho", 
        "_(Hiri Motu )"
    ], 
    [
        "hr", 
        "_(Croatian )"
    ], 
    [
        "hu", 
        "_(Hungarian )"
    ], 
    [
        "hy", 
        "_(Armenian )"
    ], 
    [
        "hz", 
        "_(Herero )"
    ], 
    [
        "ia", 
        "_(Interlingua )"
    ], 
    [
        "id", 
        "_(Indonesian (formerly in) )"
    ], 
    [
        "ie", 
        "_(Interlingue )"
    ], 
    [
        "ik", 
        "_(Inupiak )"
    ], 
    [
        "io", 
        "_(Ido )"
    ], 
    [
        "is", 
        "_(Icelandic )"
    ], 
    [
        "it", 
        "_(Italian )"
    ], 
    [
        "iu", 
        "_(Inuktitut )"
    ], 
    [
        "ja", 
        "_(Japanese )"
    ], 
    [
        "jv", 
        "_(Javanese )"
    ], 
    [
        "ka", 
        "_(Georgian )"
    ], 
    [
        "ki", 
        "_(Kikuyu )"
    ], 
    [
        "kj", 
        "_(Kuanyama )"
    ], 
    [
        "kk", 
        "_(Kazakh )"
    ], 
    [
        "kl", 
        "_(Kalaallisut; Greenlandic )"
    ], 
    [
        "km", 
        "_(Khmer; Cambodian )"
    ], 
    [
        "kn", 
        "_(Kannada )"
    ], 
    [
        "ko", 
        "_(Korean )"
    ], 
    [
        "ks", 
        "_(Kashmiri )"
    ], 
    [
        "ku", 
        "_(Kurdish )"
    ], 
    [
        "kv", 
        "_(Komi )"
    ], 
    [
        "kw", 
        "_(Cornish )"
    ], 
    [
        "ky", 
        "_(Kirghiz )"
    ], 
    [
        "la", 
        "_(Latin )"
    ], 
    [
        "lb", 
        "_(Letzeburgesch )"
    ], 
    [
        "ln", 
        "_(Lingala )"
    ], 
    [
        "lo", 
        "_(Lao; Laotian )"
    ], 
    [
        "lt", 
        "_(Lithuanian )"
    ], 
    [
        "lv", 
        "_(Latvian; Lettish )"
    ], 
    [
        "mg", 
        "_(Malagasy )"
    ], 
    [
        "mh", 
        "_(Marshall )"
    ], 
    [
        "mi", 
        "_(Maori )"
    ], 
    [
        "mk", 
        "_(Macedonian )"
    ], 
    [
        "ml", 
        "_(Malayalam )"
    ], 
    [
        "mn", 
        "_(Mongolian )"
    ], 
    [
        "mo", 
        "_(Moldavian )"
    ], 
    [
        "mr", 
        "_(Marathi )"
    ], 
    [
        "ms", 
        "_(Malay )"
    ], 
    [
        "mt", 
        "_(Maltese )"
    ], 
    [
        "my", 
        "_(Burmese )"
    ], 
    [
        "na", 
        "_(Nauru )"
    ], 
    [
        "nb", 
        "_(Norwegian Bokm\u00e5l )"
    ], 
    [
        "nd", 
        "_(Ndebele, North )"
    ], 
    [
        "ne", 
        "_(Nepali )"
    ], 
    [
        "ng", 
        "_(Ndonga )"
    ], 
    [
        "nl", 
        "_(Dutch )"
    ], 
    [
        "nn", 
        "_(Norwegian Nynorsk )"
    ], 
    [
        "no", 
        "_(Norwegian )"
    ], 
    [
        "nr", 
        "_(Ndebele, South )"
    ], 
    [
        "nv", 
        "_(Navajo )"
    ], 
    [
        "ny", 
        "_(Chichewa; Nyanja )"
    ], 
    [
        "oc", 
        "_(Occitan; Proven\u00e7al )"
    ], 
    [
        "om", 
        "_((Afan) Oromo )"
    ], 
    [
        "or", 
        "_(Oriya )"
    ], 
    [
        "os", 
        "_(Ossetian; Ossetic )"
    ], 
    [
        "pa", 
        "_(Panjabi; Punjabi )"
    ], 
    [
        "pi", 
        "_(Pali )"
    ], 
    [
        "pl", 
        "_(Polish )"
    ], 
    [
        "ps", 
        "_(Pashto, Pushto )"
    ], 
    [
        "pt", 
        "_(Portuguese )"
    ], 
    [
        "qu", 
        "_(Quechua )"
    ], 
    [
        "rm", 
        "_(Rhaeto-Romance )"
    ], 
    [
        "rn", 
        "_(Rundi; Kirundi )"
    ], 
    [
        "ro", 
        "_(Romanian )"
    ], 
    [
        "ru", 
        "_(Russian )"
    ], 
    [
        "rw", 
        "_(Kinyarwanda )"
    ], 
    [
        "sa", 
        "_(Sanskrit )"
    ], 
    [
        "sc", 
        "_(Sardinian )"
    ], 
    [
        "sd", 
        "_(Sindhi )"
    ], 
    [
        "se", 
        "_(Northern Sami )"
    ], 
    [
        "sg", 
        "_(Sango; Sangro )"
    ], 
    [
        "si", 
        "_(Sinhalese )"
    ], 
    [
        "sk", 
        "_(Slovak )"
    ], 
    [
        "sl", 
        "_(Slovenian )"
    ], 
    [
        "sm", 
        "_(Samoan )"
    ], 
    [
        "sn", 
        "_(Shona )"
    ], 
    [
        "so", 
        "_(Somali )"
    ], 
    [
        "sq", 
        "_(Albanian )"
    ], 
    [
        "sr", 
        "_(Serbian )"
    ], 
    [
        "ss", 
        "_(Swati; Siswati )"
    ], 
    [
        "st", 
        "_(Sesotho; Sotho, Southern )"
    ], 
    [
        "su", 
        "_(Sundanese )"
    ], 
    [
        "sv", 
        "_(Swedish )"
    ], 
    [
        "sw", 
        "_(Swahili )"
    ], 
    [
        "ta", 
        "_(Tamil )"
    ], 
    [
        "te", 
        "_(Telugu )"
    ], 
    [
        "tg", 
        "_(Tajik )"
    ], 
    [
        "th", 
        "_(Thai )"
    ], 
    [
        "ti", 
        "_(Tigrinya )"
    ], 
    [
        "tk", 
        "_(Turkmen )"
    ], 
    [
        "tl", 
        "_(Tagalog )"
    ], 
    [
        "tn", 
        "_(Tswana; Setswana )"
    ], 
    [
        "to", 
        "_(Tongan  )"
    ], 
    [
        "tr", 
        "_(Turkish )"
    ], 
    [
        "ts", 
        "_(Tsonga )"
    ], 
    [
        "tt", 
        "_(Tatar )"
    ], 
    [
        "tw", 
        "_(Twi )"
    ], 
    [
        "ty", 
        "_(Tahitian )"
    ], 
    [
        "ug", 
        "_(Uighur )"
    ], 
    [
        "uk", 
        "_(Ukrainian )"
    ], 
    [
        "ur", 
        "_(Urdu )"
    ], 
    [
        "uz", 
        "_(Uzbek )"
    ], 
    [
        "vi", 
        "_(Vietnamese )"
    ], 
    [
        "vo", 
        "_(Volap\u00fck; Volapuk )"
    ], 
    [
        "wa", 
        "_(Walloon )"
    ], 
    [
        "wo", 
        "_(Wolof )"
    ], 
    [
        "xh", 
        "_(Xhosa )"
    ], 
    [
        "yi", 
        "_(Yiddish (formerly ji) )"
    ], 
    [
        "yo", 
        "_(Yoruba )"
    ], 
    [
        "za", 
        "_(Zhuang )"
    ], 
    [
        "zh", 
        "_(Chinese )"
    ], 
    [
        "zu", 
        "_(Zulu )"
    ]
];

Ext.define('eXe.view.forms.MetadataPanel', {
    extend: 'Ext.form.Panel',
    alias: 'widget.metadata',

    requires: ['eXe.view.forms.HelpContainer'],
    
    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'fieldset',
                    title: _('Dublin Core Metadata'),
                    margin: 10,
                    items: [
                        {
                            xtype: 'textfield',
                            inputId: 'dc_title',
                            fieldLabel: _('Title'),
                            tooltip: _('The name given to the resource.'),
                            anchor: '100%'
                        },
                        {
                            xtype: 'textfield',
                            inputId: 'dc_creator',
                            fieldLabel: _('Creator'),
                            tooltip: _('An entity primarily responsible for making the content of the resource.'),
                            anchor: '100%'
                        },
                        {
                            xtype: 'helpcontainer',
                            item: {
                                xtype: 'textfield',
	                            inputId: 'dc_subject',
	                            fieldLabel: _('Subject'),
	                            tooltip: _('The topic of the content of the resource.'),
	                            anchor: '100%'
                            },
                            help: _('Typically, Subject will be expressed as keywords, key phrases or classification codes that describe a topic of the resource. Recommended best practice is to select a value from a controlled vocabulary or formal classification scheme.')
                        },
                        {
                            xtype: 'textarea',
                            inputId: 'dc_description',
                            fieldLabel: _('Description'),
                            tooltip: _('An account of the content of the resource.'),
                            height: 80,
                            anchor: '100%'
                        },
                        {
                            xtype: 'textfield',
                            inputId: 'dc_publisher',
                            fieldLabel: _('Publisher'),
                            tooltip: _('An entity responsible for making the resource available.'),
                            anchor: '100%'
                        },
                        {
                            xtype: 'textarea',
                            inputId: 'dc_contributors',
                            fieldLabel: _('Contributors'),
                            tooltip: _('An entity responsible for making contributions to the content of the resource.'),
                            anchor: '100%'
                        },
                        {
                            xtype: 'helpcontainer',
                            item: {
                                xtype: 'datefield',
                                format: 'Y-m-d',
                                validateOnBlur: false,
                                validateOnChange: false,
                                pickerAlign: 'tr-br',
	                            inputId: 'dc_date',
	                            fieldLabel: _('Date'),
	                            tooltip: _('A date of an event in the lifecycle of the resource.'),
	                            anchor: '100%'
                            },
                            help: _('Typically, Date will be associated with the creation or availability of the resource. Recommended best practice for encoding the date value is defined in a profile called <em>ISO 8601</em> <a href="/docs/W3C-NOTE-datetime.html" target="_blank">W3C Date and Time Formats</a> and includes (among others) dates of the form YYYY-MM-DD.')
                        },
                        {
                            xtype: 'helpcontainer',
                            item: {
                                xtype: 'textfield',
	                            inputId: 'dc_type',
	                            fieldLabel: _('Type'),
	                            tooltip: _('The nature or genre of the content of the resource.'),
	                            anchor: '100%'
                            },
                            help: _('Type includes terms describing general categories, functions, or genres, for content. Recommended best practice is to select a value from a controlled vocabulary or controlled classification scheme. To describe the physical or digital manifestation of the resource, use the FORMAT element.')
                        },
                        {
                            xtype: 'combobox',
                            inputId: 'dc_format',
                            fieldLabel: _('Format'),
                            store: [
                                ['XHTML', 'XHTML'],
                                ['SCORM 1.2', 'SCORM 1.2'],
                                ['IMS-CP', 'IMS Content Package 1.1.3'],
                                ['Web Site', 'Web Site']
                            ],
                            tooltip: _('Select a Format.'),
                            anchor: '100%'
                        },
                        {
                            xtype: 'textfield',
                            inputId: 'dc_identifier',
                            fieldLabel: _('Identifier'),
                            tooltip: _('An unambiguous reference to the resource within a given context.'),
                            anchor: '100%'
                        },
                        {
                            xtype: 'textfield',
                            inputId: 'dc_source',
                            fieldLabel: _('Source'),
                            tooltip: _('A Reference to a resource from which the present resource is derived.'),
                            anchor: '100%'
                        },
                        {
                            xtype: 'combobox',
                            inputId: 'dc_language',
                            fieldLabel: _('Language'),
                            store: langs,
                            tooltip: _('Select a language.'),
                            anchor: '100%'
                        },
                        {
                            xtype: 'textfield',
                            inputId: 'dc_relation',
                            fieldLabel: _('Relation'),
                            tooltip: _('A reference to a related resource.'),
                            anchor: '100%'
                        },
                        {
                            xtype: 'textfield',
                            inputId: 'dc_coverage',
                            fieldLabel: _('Coverage'),
                            tooltip: _('The extent or scope of the content of the resource.'),
                            anchor: '100%'
                        },
                        {
                            xtype: 'helpcontainer',
                            item: {
                                xtype: 'textfield',
                                inputId: 'dc_rights',
                                fieldLabel: _('Rights'),
                                tooltip: _('Information about rights held in and over the resource.'),
                                anchor: '100%'
                            },
                            help: _('Typically, a Rights element will contain a rights management statement for the resource, or reference a service providing such information. Rights information often encompasses Intellectual Property Rights (IPR), Copyright, and various Property Rights. If the Rights element is absent, no assumptions can be made about the status of these and other rights with respect to the resource.')
                        }
                    ]
                },
                {
                    xtype: 'button',
                    text: _('Apply'),
                    margin: 10,
                    handler: function() {
                        var form = this.up('form').getForm();
                        if (form.isValid()) {
                            form.submit({ 
		                        failure: function(form, action) {
		                            Ext.Msg.alert(_('Error'), action.result.errorMessage);
		                        }
		                    });
                        }
                    }                            
                }
            ],
            listeners: {
                'beforeaction': function(form, action, eOpts) {
                    form.url = location.pathname + "/properties"
                },
                'show': function() {
                    this.load({ 
                        method: "GET", 
                        params: this.getForm().getFieldValues(),
                        failure: function(form, action) {
                            Ext.Msg.alert(_('Error'), action.result.errorMessage);
                        }
                    });
                }
            }
        });

        me.callParent(arguments);
    }

});