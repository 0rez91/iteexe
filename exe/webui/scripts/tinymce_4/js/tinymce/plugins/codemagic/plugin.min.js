/**
 *
 *
 * @author Josh Lobe
 * http://ultimatetinymcepro.com
 
 * CodeMagic is a replacement source code editor plugin for Tinymce which integrates the CodeMirror (http://www.codemirror.net/) library for syntax highlighting.  
 * Adapted to eXeLearning by Ignacio Gros (http://gros.es/)
 * Compare this file with plugin.js to see what's different (we use eXe's _ function to translate the strings, etc.).
 */
 
jQuery(document).ready(function($) {

	tinymce.PluginManager.add('codemagic', function(editor, url) {
		
		// According to http://archive.tinymce.com/wiki.php/Tutorials:Creating_a_plugin, this should be in langs/all.js, but that doesn't work
		tinymce.addI18n('all', {
			'Edit source code': _('Edit source code'),
			'Wrap text': _('Wrap text'),
			'Auto completion': _('Auto close tags'),
			'Highlight Code': _('Highlight syntax'),
			'Undo': _('Undo'),
			'Redo': _('Redo'),
			'Search and Replace': _('Search and Replace'),
			'Search': _('Search'),
			'Replace': _('Replace'),
			'Cancel': _('Cancel'),
			'Insert and Close': _('Update'),
			'Reformat': _('Reformat'),
			'Format HTML Code': _('Format HTML Code')
		});
		
		editor.addButton('codemagic', {
			image: url + '/images/html.png',
			tooltip: _('Edit source code'),
			onclick: open_codemagic
		});	
		
		editor.addMenuItem('codemagic', {
			icon: 'code',
			text: _('Edit source code'),
			onclick: open_codemagic,
			context: 'tools'
		});
		
		function open_codemagic() {
			editor.windowManager.open({
				title: _('Edit source code'),
				width: 900,
				height: 650,
				url: url+'/codemagic.htm'
			});
		}
		
	});
});